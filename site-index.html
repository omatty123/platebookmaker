<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Platebook Generator</title>
<style>
body { font-family: serif; margin: 40px; }
button { font-size: 16px; }
</style>
</head>

<body>

<h1>Platebook Generator</h1>

<p>
Upload a <code>lessons.json</code> file.  
GitHub will generate a Platebook PDF for download.
</p>

<form id="form">
  <input type="file" id="file" accept=".json" required>
  <br><br>
  <button type="submit">Generate Platebook</button>
</form>

<p id="status"></p>

<script>
const form = document.getElementById("form");
const status = document.getElementById("status");

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  status.textContent = "Uploading… generating PDF (≈20–30 seconds)…";

  const file = document.getElementById("file").files[0];
  const text = await file.text();

  const res = await fetch(
    "https://api.github.com/repos/YOUR-USERNAME/platebook-generator/dispatches",
    {
      method: "POST",
      headers: {
        "Accept": "application/vnd.github+json",
        "Authorization": "Bearer YOUR_GITHUB_TOKEN"
      },
      body: JSON.stringify({
        event_type: "generate",
        client_payload: { lessons: text }
      })
    }
  );

  if (res.ok) {
    status.innerHTML =
      `Generation started.<br>
       Go to <a href="https://github.com/YOUR-USERNAME/platebook-generator/actions">
       Actions → latest run → Artifacts</a> to download the PDF.`;
  } else {
    status.textContent = "Error starting generation.";
  }
});
</script>

</body>
</html>
